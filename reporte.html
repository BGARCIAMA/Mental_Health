<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lauro Reyes Rosas - 214532">
<meta name="author" content="Blanca Estela García Manjarrez - 118886">
<meta name="author" content="Yuneri Pérez Arellano - 199813">
<meta name="dcterms.date" content="2024-12-11">

<title>Mental Health</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="Reporte_files/libs/clipboard/clipboard.min.js"></script>
<script src="Reporte_files/libs/quarto-html/quarto.js"></script>
<script src="Reporte_files/libs/quarto-html/popper.min.js"></script>
<script src="Reporte_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Reporte_files/libs/quarto-html/anchor.min.js"></script>
<link href="Reporte_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Reporte_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Reporte_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Reporte_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Reporte_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mental Health</h1>
<p class="subtitle lead">ITAM - Aprendizaje de Máquina</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Lauro Reyes Rosas - 214532 </p>
             <p>Blanca Estela García Manjarrez - 118886 </p>
             <p>Yuneri Pérez Arellano - 199813 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 11, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>



<section id="mental-health" class="level1">
<h1>Mental Health</h1>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>En el presente proyecto se abordarán los distintos modelos utilizados para predecir la variable objetivo <strong>Depresión</strong> utilizando un conjunto de datos titulado <a href="https://www.kaggle.com/competitions/playground-series-s4e11/data"><strong>Salud Mental</strong></a>.</p>
<p>Este dataset, es el resultado de una encuesta integral cuyo propósito fue analizar los factores asociados al riesgo de depresión en adultos. La comprensión de estos factores puede contribuir al desarrollo de intervenciones más efectivas en el ámbito de la salud mental.</p>
<p>La encuesta fue llevada a cabo de manera anónima entre enero y junio de 2023 en diversas ciudades, involucrando a personas de diferentes orígenes y profesiones. Los participantes, con edades entre 18 y 60 años, compartieron voluntariamente información sobre una amplia variedad de aspectos, tales como edad, género, ciudad de residencia, entre otros.</p>
<p>El conjunto de datos contiene 140,700 registros en el conjunto de entrenamiento y está compuesto por 20 variables, descritas a continuación:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 41%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>id</code></td>
<td>Identificador único del registro</td>
</tr>
<tr class="even">
<td><code>Nombre</code></td>
<td>Nombre del participante</td>
</tr>
<tr class="odd">
<td><code>Género</code></td>
<td>Género del participante</td>
</tr>
<tr class="even">
<td><code>Edad</code></td>
<td>Edad del participante</td>
</tr>
<tr class="odd">
<td><code>Ciudad</code></td>
<td>Ciudad de residencia</td>
</tr>
<tr class="even">
<td><code>Profesionista/Estudiante</code></td>
<td>Ocupación principal</td>
</tr>
<tr class="odd">
<td><code>Profesión</code></td>
<td>Campo laboral o académico</td>
</tr>
<tr class="even">
<td><code>Presión_académica</code></td>
<td>Nivel de presión relacionado con los estudios</td>
</tr>
<tr class="odd">
<td><code>Presión_laboral</code></td>
<td>Nivel de presión relacionado con el trabajo</td>
</tr>
<tr class="even">
<td><code>CGPA</code></td>
<td>Promedio general acumulado</td>
</tr>
<tr class="odd">
<td><code>Satisfacción_académica</code></td>
<td>Nivel de satisfacción con los estudios</td>
</tr>
<tr class="even">
<td><code>Satisfacción_laboral</code></td>
<td>Nivel de satisfacción con el trabajo</td>
</tr>
<tr class="odd">
<td><code>Tiempo_dormir</code></td>
<td>Horas promedio de sueño por día</td>
</tr>
<tr class="even">
<td><code>Hábitos_alimenticios</code></td>
<td>Calidad percibida de los hábitos alimenticios</td>
</tr>
<tr class="odd">
<td><code>Grado_académico</code></td>
<td>Nivel más alto de educación alcanzado</td>
</tr>
<tr class="even">
<td><code>Pensamientos_suicidas</code></td>
<td>Indicadores de pensamientos suicidas</td>
</tr>
<tr class="odd">
<td><code>Horas_estudio/trabajo</code></td>
<td>Promedio de horas dedicadas a estudio o trabajo</td>
</tr>
<tr class="even">
<td><code>Estrés_financiero</code></td>
<td>Percepción de presión financiera</td>
</tr>
<tr class="odd">
<td><code>Antecedente_familiar_enfermedad_mental</code></td>
<td>Presencia de antecedentes familiares de enfermedad mental</td>
</tr>
<tr class="even">
<td><strong><code>Depresión</code></strong></td>
<td><strong>Indicador binario de depresión (variable objetivo)</strong></td>
</tr>
</tbody>
</table>
<p>El análisis de este conjunto de datos, permitirá explorar y modelar las relaciones entre las variables predictoras y la variable objetivo, contribuyendo así a un mejor entendimiento del impacto de diversos factores en la salud mental.</p>
</section>
<section id="exploratory-data-analysis-eda" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</h2>
<div id="info" class="cell" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 140700 entries, 0 to 140699
Data columns (total 20 columns):
 #   Column                                 Non-Null Count   Dtype  
---  ------                                 --------------   -----  
 0   id                                     140700 non-null  int64  
 1   name                                   140700 non-null  object 
 2   gender                                 140700 non-null  object 
 3   age                                    140700 non-null  float64
 4   city                                   140700 non-null  object 
 5   working_professional_or_student        140700 non-null  object 
 6   profession                             104070 non-null  object 
 7   academic_pressure                      27897 non-null   float64
 8   work_pressure                          112782 non-null  float64
 9   cgpa                                   27898 non-null   float64
 10  study_satisfaction                     27897 non-null   float64
 11  job_satisfaction                       112790 non-null  float64
 12  sleep_duration                         140700 non-null  object 
 13  dietary_habits                         140696 non-null  object 
 14  degree                                 140698 non-null  object 
 15  have_you_ever_had_suicidal_thoughts_?  140700 non-null  object 
 16  work/study_hours                       140700 non-null  float64
 17  financial_stress                       140696 non-null  float64
 18  family_history_of_mental_illness       140700 non-null  object 
 19  depression                             140700 non-null  int64  
dtypes: float64(8), int64(2), object(10)
memory usage: 21.5+ MB</code></pre>
</div>
</div>
<p>El conjunto de entrenamiento consta de 140,700 registros y 20 columnas.</p>
<p><strong>Variables numéricas</strong></p>
<div id="529175f2" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display" data-execution_count="3">
<style type="text/css">
</style>

<table id="T_1b0bc" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_1b0bc_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">id</th>
<th id="T_1b0bc_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">age</th>
<th id="T_1b0bc_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">academic_pressure</th>
<th id="T_1b0bc_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">work_pressure</th>
<th id="T_1b0bc_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">cgpa</th>
<th id="T_1b0bc_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">study_satisfaction</th>
<th id="T_1b0bc_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">job_satisfaction</th>
<th id="T_1b0bc_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">work/study_hours</th>
<th id="T_1b0bc_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">financial_stress</th>
<th id="T_1b0bc_level0_col9" class="col_heading level0 col9" data-quarto-table-cell-role="th">depression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_1b0bc_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">count</td>
<td id="T_1b0bc_row0_col0" class="data row0 col0">140700.00</td>
<td id="T_1b0bc_row0_col1" class="data row0 col1">140700.00</td>
<td id="T_1b0bc_row0_col2" class="data row0 col2">27897.00</td>
<td id="T_1b0bc_row0_col3" class="data row0 col3">112782.00</td>
<td id="T_1b0bc_row0_col4" class="data row0 col4">27898.00</td>
<td id="T_1b0bc_row0_col5" class="data row0 col5">27897.00</td>
<td id="T_1b0bc_row0_col6" class="data row0 col6">112790.00</td>
<td id="T_1b0bc_row0_col7" class="data row0 col7">140700.00</td>
<td id="T_1b0bc_row0_col8" class="data row0 col8">140696.00</td>
<td id="T_1b0bc_row0_col9" class="data row0 col9">140700.00</td>
</tr>
<tr class="even">
<td id="T_1b0bc_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">mean</td>
<td id="T_1b0bc_row1_col0" class="data row1 col0">70349.50</td>
<td id="T_1b0bc_row1_col1" class="data row1 col1">40.39</td>
<td id="T_1b0bc_row1_col2" class="data row1 col2">3.14</td>
<td id="T_1b0bc_row1_col3" class="data row1 col3">3.00</td>
<td id="T_1b0bc_row1_col4" class="data row1 col4">7.66</td>
<td id="T_1b0bc_row1_col5" class="data row1 col5">2.94</td>
<td id="T_1b0bc_row1_col6" class="data row1 col6">2.97</td>
<td id="T_1b0bc_row1_col7" class="data row1 col7">6.25</td>
<td id="T_1b0bc_row1_col8" class="data row1 col8">2.99</td>
<td id="T_1b0bc_row1_col9" class="data row1 col9">0.18</td>
</tr>
<tr class="odd">
<td id="T_1b0bc_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">std</td>
<td id="T_1b0bc_row2_col0" class="data row2 col0">40616.74</td>
<td id="T_1b0bc_row2_col1" class="data row2 col1">12.38</td>
<td id="T_1b0bc_row2_col2" class="data row2 col2">1.38</td>
<td id="T_1b0bc_row2_col3" class="data row2 col3">1.41</td>
<td id="T_1b0bc_row2_col4" class="data row2 col4">1.46</td>
<td id="T_1b0bc_row2_col5" class="data row2 col5">1.36</td>
<td id="T_1b0bc_row2_col6" class="data row2 col6">1.42</td>
<td id="T_1b0bc_row2_col7" class="data row2 col7">3.85</td>
<td id="T_1b0bc_row2_col8" class="data row2 col8">1.41</td>
<td id="T_1b0bc_row2_col9" class="data row2 col9">0.39</td>
</tr>
<tr class="even">
<td id="T_1b0bc_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">min</td>
<td id="T_1b0bc_row3_col0" class="data row3 col0">0.00</td>
<td id="T_1b0bc_row3_col1" class="data row3 col1">18.00</td>
<td id="T_1b0bc_row3_col2" class="data row3 col2">1.00</td>
<td id="T_1b0bc_row3_col3" class="data row3 col3">1.00</td>
<td id="T_1b0bc_row3_col4" class="data row3 col4">5.03</td>
<td id="T_1b0bc_row3_col5" class="data row3 col5">1.00</td>
<td id="T_1b0bc_row3_col6" class="data row3 col6">1.00</td>
<td id="T_1b0bc_row3_col7" class="data row3 col7">0.00</td>
<td id="T_1b0bc_row3_col8" class="data row3 col8">1.00</td>
<td id="T_1b0bc_row3_col9" class="data row3 col9">0.00</td>
</tr>
<tr class="odd">
<td id="T_1b0bc_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">25%</td>
<td id="T_1b0bc_row4_col0" class="data row4 col0">35174.75</td>
<td id="T_1b0bc_row4_col1" class="data row4 col1">29.00</td>
<td id="T_1b0bc_row4_col2" class="data row4 col2">2.00</td>
<td id="T_1b0bc_row4_col3" class="data row4 col3">2.00</td>
<td id="T_1b0bc_row4_col4" class="data row4 col4">6.29</td>
<td id="T_1b0bc_row4_col5" class="data row4 col5">2.00</td>
<td id="T_1b0bc_row4_col6" class="data row4 col6">2.00</td>
<td id="T_1b0bc_row4_col7" class="data row4 col7">3.00</td>
<td id="T_1b0bc_row4_col8" class="data row4 col8">2.00</td>
<td id="T_1b0bc_row4_col9" class="data row4 col9">0.00</td>
</tr>
<tr class="even">
<td id="T_1b0bc_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">50%</td>
<td id="T_1b0bc_row5_col0" class="data row5 col0">70349.50</td>
<td id="T_1b0bc_row5_col1" class="data row5 col1">42.00</td>
<td id="T_1b0bc_row5_col2" class="data row5 col2">3.00</td>
<td id="T_1b0bc_row5_col3" class="data row5 col3">3.00</td>
<td id="T_1b0bc_row5_col4" class="data row5 col4">7.77</td>
<td id="T_1b0bc_row5_col5" class="data row5 col5">3.00</td>
<td id="T_1b0bc_row5_col6" class="data row5 col6">3.00</td>
<td id="T_1b0bc_row5_col7" class="data row5 col7">6.00</td>
<td id="T_1b0bc_row5_col8" class="data row5 col8">3.00</td>
<td id="T_1b0bc_row5_col9" class="data row5 col9">0.00</td>
</tr>
<tr class="odd">
<td id="T_1b0bc_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">75%</td>
<td id="T_1b0bc_row6_col0" class="data row6 col0">105524.25</td>
<td id="T_1b0bc_row6_col1" class="data row6 col1">51.00</td>
<td id="T_1b0bc_row6_col2" class="data row6 col2">4.00</td>
<td id="T_1b0bc_row6_col3" class="data row6 col3">4.00</td>
<td id="T_1b0bc_row6_col4" class="data row6 col4">8.92</td>
<td id="T_1b0bc_row6_col5" class="data row6 col5">4.00</td>
<td id="T_1b0bc_row6_col6" class="data row6 col6">4.00</td>
<td id="T_1b0bc_row6_col7" class="data row6 col7">10.00</td>
<td id="T_1b0bc_row6_col8" class="data row6 col8">4.00</td>
<td id="T_1b0bc_row6_col9" class="data row6 col9">0.00</td>
</tr>
<tr class="even">
<td id="T_1b0bc_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">max</td>
<td id="T_1b0bc_row7_col0" class="data row7 col0">140699.00</td>
<td id="T_1b0bc_row7_col1" class="data row7 col1">60.00</td>
<td id="T_1b0bc_row7_col2" class="data row7 col2">5.00</td>
<td id="T_1b0bc_row7_col3" class="data row7 col3">5.00</td>
<td id="T_1b0bc_row7_col4" class="data row7 col4">10.00</td>
<td id="T_1b0bc_row7_col5" class="data row7 col5">5.00</td>
<td id="T_1b0bc_row7_col6" class="data row7 col6">5.00</td>
<td id="T_1b0bc_row7_col7" class="data row7 col7">12.00</td>
<td id="T_1b0bc_row7_col8" class="data row7 col8">5.00</td>
<td id="T_1b0bc_row7_col9" class="data row7 col9">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>El análisis exploratorio de las variables numéricas, revela que las relacionadas con <code>satisfacción</code>, <code>presión</code> y <code>estrés</code> están en una escala de 1 a 5, con medias cercanas a 3. La <code>edad</code> de los participantes oscila entre 18 y 60 años, con una media de 40.4, mientras que las horas de <code>trabajo/estudio</code> tienen una media de 6.25 horas diarias. El <em>rendimiento académico</em> (<code>CGPA</code>) muestra valores altos, con una media de 7.66. La variable objetivo, <em><code>depression</code></em>, indica que alrededor del 18% de los participantes presenta riesgo de depresión.</p>
<p><strong>Variables categóricas</strong></p>
<div id="7d015333" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">working_professional_or_student</th>
<th data-quarto-table-cell-role="th">profession</th>
<th data-quarto-table-cell-role="th">sleep_duration</th>
<th data-quarto-table-cell-role="th">dietary_habits</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">have_you_ever_had_suicidal_thoughts_?</th>
<th data-quarto-table-cell-role="th">family_history_of_mental_illness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>140700</td>
<td>140700</td>
<td>140700</td>
<td>140700</td>
<td>104070</td>
<td>140700</td>
<td>140696</td>
<td>140698</td>
<td>140700</td>
<td>140700</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">unique</td>
<td>422</td>
<td>2</td>
<td>98</td>
<td>2</td>
<td>64</td>
<td>36</td>
<td>23</td>
<td>115</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">top</td>
<td>Rohan</td>
<td>Male</td>
<td>Kalyan</td>
<td>Working Professional</td>
<td>Teacher</td>
<td>Less than 5 hours</td>
<td>Moderate</td>
<td>Class 12</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">freq</td>
<td>3178</td>
<td>77464</td>
<td>6591</td>
<td>112799</td>
<td>24906</td>
<td>38784</td>
<td>49705</td>
<td>14729</td>
<td>71138</td>
<td>70758</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>En cuanto a las variables categóricas, destacan 98 ciudades únicas y 64 profesiones, con “<code>Teacher</code>” como la más común. Duraciones de sueño como “<code>Less than 5 hours</code>” son las más reportadas, mientras que los antecedentes familiares de enfermedad mental y pensamientos suicidas tienen predominancia de respuestas negativas. Estos resultados iniciales subrayan la diversidad del dataset y señalan áreas clave para el tratamiento de datos, como los valores nulos y categorías con alta cardinalidad.</p>
<section id="variable-objetivo" class="level4">
<h4 class="anchored" data-anchor-id="variable-objetivo">Variable Objetivo</h4>
<p>::: {#cell-target variable dist .cell execution_count=5}</p>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/target-variable-dist-output-1.png" id="target-variable-dist" width="463" height="486" class="figure-img"></p>
</figure>
</div>
</div>
<p>:::</p>
<p>El análisis de la variable objetivo <code>depression</code> revela un conjunto de datos desbalanceado, donde aproximadamente el 82% de los registros corresponden a individuos sin depresión y solo el 18% a casos positivos. Esta desigualdad es visualmente evidente en la gráfica de distribución.</p>
<p>El desbalance en la variable objetivo, establece un desafío en el modelado predictivo, ya que los modelos pueden inclinarse hacia la clase mayoritaria. Sin embargo, también sugiere que un punto de referencia inicial para la métrica de precisión (<em>accuracy</em>) debe superar el 82%, ya que ese sería el desempeño esperado al predecir siempre la clase mayoritaria.</p>
</section>
<section id="revisión-de-valores-nulos" class="level4">
<h4 class="anchored" data-anchor-id="revisión-de-valores-nulos">Revisión de valores nulos</h4>
<p>::: {#cell-NA check .cell execution_count=6}</p>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/na-check-output-1.png" id="na-check" width="675" height="592" class="figure-img"></p>
</figure>
</div>
</div>
<p>:::</p>
<p>En particular, las variables relacionadas con estudiantes, como <code>academic_pressure</code>, <code>cgpa</code>, y <code>study_satisfaction</code>, presentan hasta un 80% de valores nulos. Este resultado refleja una menor representación de estudiantes en comparación con profesionistas dentro del dataset.</p>
<p>A pesar del alto porcentaje de valores faltantes en estas variables, no se eliminarán del análisis, ya que contienen información valiosa para los casos específicos de estudiantes. Este enfoque permite preservar datos que pueden ser relevantes en el desarrollo del modelo predictivo, especialmente para evaluar las diferencias entre grupos ocupacionales. Las estrategias de imputación y tratamiento de valores nulos serán fundamentales para garantizar la calidad del análisis posterior.</p>
</section>
<section id="ingenieria-de-variables" class="level4">
<h4 class="anchored" data-anchor-id="ingenieria-de-variables">Ingenieria de Variables</h4>
<p>Se añadieron características derivadas para enriquecer el dataset y mejorar el análisis. Estas incluyen:</p>
<ul>
<li><code>satisfaction_by_work</code>: Relación entre presión laboral y satisfacción en el trabajo.</li>
<li><code>satisfaction_by_study</code>: Relación entre presión y satisfacción académica.</li>
<li><code>age_work_satisfaction</code>: Razón entre edad y satisfacción laboral.</li>
<li><code>cgpa_study</code>: Relación entre promedio académico y presión académica.</li>
</ul>
<p>Estas nuevas variables buscan capturar interacciones clave, como el impacto de la presión en la satisfacción o el desempeño bajo diferentes condiciones, y tienen el potencial de mejorar el modelo predictivo. Las varibales se crean con la siguiente función:</p>
<div id="new-feats" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> new_feats(df):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        df.assign(satisfaction_by_work<span class="op">=</span>df[<span class="st">"work_pressure"</span>] <span class="op">/</span> df[<span class="st">"job_satisfaction"</span>])</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        .assign(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>            satisfaction_by_study<span class="op">=</span>df[<span class="st">"academic_pressure"</span>] <span class="op">/</span> df[<span class="st">"study_satisfaction"</span>]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        .assign(age_work_satisfaction<span class="op">=</span>df[<span class="st">"age"</span>] <span class="op">/</span> df[<span class="st">"job_satisfaction"</span>])</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        .assign(cgpa_study<span class="op">=</span>df[<span class="st">"cgpa"</span>] <span class="op">/</span> df[<span class="st">"academic_pressure"</span>])</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> new_feats(train).copy()</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> new_feats(test).copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dado que algunas variables categóricas presentan un gran número de categorías únicas, se implementó una estrategia para agrupar las categorías menos representativas en una etiqueta denominada “<em>Other</em>”. Esto asegura que las categorías seleccionadas representen al menos el 90% de los datos, reduciendo la dimensionalidad y facilitando el análisis.</p>
<p>Las columnas ajustadas incluyen:</p>
<ul>
<li><code>city</code></li>
<li><code>profession</code></li>
<li><code>sleep_duration</code></li>
<li><code>dietary_habits</code></li>
<li><code>degree</code></li>
</ul>
<p>Esta transformación permite simplificar la estructura del dataset sin perder información relevante, mejorando la manejabilidad del modelo y reduciendo el riesgo de sobreajuste debido a categorías con baja frecuencia.</p>
<div id="c8727f25" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">"city"</span>], test[<span class="st">"city"</span>] <span class="op">=</span> group_low_frequency(train, test, <span class="st">'city'</span>, <span class="fl">0.9</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>train[<span class="st">"profession"</span>], test[<span class="st">"profession"</span>] <span class="op">=</span> group_low_frequency(train, test, <span class="st">'profession'</span>, <span class="fl">0.9</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>train[<span class="st">"sleep_duration"</span>], test[<span class="st">"sleep_duration"</span>] <span class="op">=</span> group_low_frequency(train, test, <span class="st">'sleep_duration'</span>, <span class="fl">0.9</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>train[<span class="st">"dietary_habits"</span>], test[<span class="st">"dietary_habits"</span>] <span class="op">=</span> group_low_frequency(train, test, <span class="st">'dietary_habits'</span>, <span class="fl">0.9</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>train[<span class="st">"degree"</span>], test[<span class="st">"degree"</span>] <span class="op">=</span> group_low_frequency(train, test, <span class="st">'degree'</span>, <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tras la agrupación, las variables categóricas principales quedan resumidas con las categorías más representativas</p>
<div id="75807f29" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">profession</th>
<th data-quarto-table-cell-role="th">sleep_duration</th>
<th data-quarto-table-cell-role="th">dietary_habits</th>
<th data-quarto-table-cell-role="th">degree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>140700</td>
<td>140700</td>
<td>140700</td>
<td>140700</td>
<td>140700</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">unique</td>
<td>26</td>
<td>27</td>
<td>4</td>
<td>3</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">top</td>
<td>Other</td>
<td>Other</td>
<td>Less than 5 hours</td>
<td>Moderate</td>
<td>Other</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">freq</td>
<td>17198</td>
<td>47065</td>
<td>38784</td>
<td>49705</td>
<td>15386</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>A continuación, se exploraron las profesiones más representativas en el dataset, se puede confirmar que la profesión con mayor frecuencia es <code>Teacher</code>, seguida de <code>Content Writer</code> y <code>Architect</code>.</p>
<div id="83042e87" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/cell-12-output-1.png" width="616" height="483" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="relación-variables-categóricas-y-depresión" class="level4">
<h4 class="anchored" data-anchor-id="relación-variables-categóricas-y-depresión">Relación variables categóricas y Depresión</h4>
<div id="bcaf8111" class="cell" data-execution_count="13">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/cell-14-output-1.png" width="1499" height="163" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>El análisis gráfico de la variable <code>work/study_hours</code> muestra un patrón interesante: a medida que aumentan las horas dedicadas al trabajo o estudio, también aumenta la proporción de casos con indicadores de depresión.</p>
<div id="f934b5a4" class="cell" data-execution_count="14">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/cell-15-output-1.png" width="729" height="163" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Los resultados muestran que más de la mitad de los estudiantes en el dataset tienen indicadores de depresión. Esto resalta una diferencia notable en comparación con los profesionales, sugiriendo que el entorno académico puede ser un factor de estrés significativo.</p>
<div id="42479484" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/cell-16-output-1.png" width="731" height="163" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Aunque hay más hombres con depresión en términos absolutos, los porcentajes de depresión entre hombres y mujeres son similares, alrededor del 18%. Esto indica que la distribución de la variable objetivo no presenta un sesgo significativo entre géneros.</p>
<div id="19e5afbc" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/cell-17-output-1.png" width="732" height="160" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Se observa una clara relación inversa entre la satisfacción en los estudios y la propensión a la depresión. A menor satisfacción académica, mayor es la proporción de casos positivos de depresión, lo que refuerza la importancia del bienestar en el ámbito educativo.</p>
<div id="5f7631af" class="cell" data-execution_count="17">
<div class="cell-output cell-output-display">
<div>                            <div id="d7151bb3-9be1-4618-8184-481cb1491851" class="plotly-graph-div" style="height:600px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d7151bb3-9be1-4618-8184-481cb1491851")) {                    Plotly.newPlot(                        "d7151bb3-9be1-4618-8184-481cb1491851",                        [{"link":{"source":[0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19],"target":[20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21,20,21],"value":[3937,433,2982,179,2723,139,2883,84,4030,199,7668,146,1962,93,2204,186,3083,172,2639,213,2906,62,3592,430,2046,166,1876,100,26680,20385,3789,104,1815,98,2234,94,23520,1386,1774,86]},"node":{"color":["rgba(161, 201, 244, 0.8)","rgba(255, 180, 130, 0.8)","rgba(141, 229, 161, 0.8)","rgba(255, 159, 155, 0.8)","rgba(208, 187, 255, 0.8)","rgba(222, 187, 155, 0.8)","rgba(250, 176, 228, 0.8)","rgba(207, 207, 207, 0.8)","rgba(255, 254, 163, 0.8)","rgba(185, 242, 240, 0.8)","rgba(161, 201, 244, 0.8)","rgba(255, 180, 130, 0.8)","rgba(141, 229, 161, 0.8)","rgba(255, 159, 155, 0.8)","rgba(208, 187, 255, 0.8)","rgba(222, 187, 155, 0.8)","rgba(250, 176, 228, 0.8)","rgba(207, 207, 207, 0.8)","rgba(255, 254, 163, 0.8)","rgba(185, 242, 240, 0.8)","rgba(161, 201, 244, 0.8)","rgba(255, 180, 130, 0.8)"],"label":["Architect","Business Analyst","Chef","Chemist","Consultant","Content Writer","Customer Support","Data Scientist","Doctor","Educational Consultant","Entrepreneur","HR Manager","Lawyer","Marketing Manager","Other","Pharmacist","Pilot","Researcher","Teacher","Travel Consultant","No Depression","Depression"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"Diagrama de Sankey de profesi\u00f3n y depresi\u00f3n"},"font":{"size":10},"width":700,"height":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d7151bb3-9be1-4618-8184-481cb1491851');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="mapa-de-correlación-entre-variable-numéricas" class="level4">
<h4 class="anchored" data-anchor-id="mapa-de-correlación-entre-variable-numéricas">Mapa de correlación entre variable numéricas</h4>
<div id="dc6878b0" class="cell" data-execution_count="18">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/cell-19-output-1.png" width="834" height="747" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="f6232201" class="cell" data-execution_count="19">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/cell-20-output-1.png" width="589" height="390" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/cell-20-output-2.png" width="589" height="390" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Reporte_files/figure-html/cell-20-output-3.png" width="590" height="390" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="modelos" class="level2">
<h2 class="anchored" data-anchor-id="modelos">Modelos</h2>
<section id="catboost" class="level3">
<h3 class="anchored" data-anchor-id="catboost">CatBoost</h3>
<p>CatBoost es un algoritmo de aprendizaje automático basado en árboles de decisión que utiliza técnicas avanzadas de boosting. Es especialmente útil para trabajar con datos categóricos, ya que implementa un manejo eficiente de estas variables mediante codificación automática, lo que reduce la necesidad de preprocesamiento adicional. Además, CatBoost es conocido por su capacidad de minimizar el riesgo de sobreajuste y su alto desempeño en tareas de clasificación y regresión.</p>
<p>Elegimos CatBoost para este ejercicio debido a la naturaleza del dataset, que contiene una combinación de variables numéricas y categóricas. Su capacidad para procesar variables categóricas de forma nativa, junto con su robustez frente al desbalance de datos, lo hace ideal para predecir nuestra variable objetivo, <strong>depression</strong>, en un conjunto de datos con estructuras y distribuciones complejas. Además, el rendimiento competitivo de CatBoost en comparación con otros algoritmos de boosting lo convierte en una opción sólida para este tipo de problema.</p>
<p>Para entrenar el modelo, el dataset se preprocesó llenando valores faltantes con “0” y ajustando los tipos de datos según la naturaleza de las variables (numéricas, categóricas y objetivo). Posteriormente, se dividieron los datos en conjuntos de entrenamiento y prueba, utilizando el 70% de los datos para entrenamiento y el 30% para prueba. Este procedimiento garantiza una evaluación justa del modelo, preservando datos no vistos para validar su desempeño y evitar el sobreajuste.</p>
<div id="catboost" class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>----------X Shape---------
(140700, 23)
*************************************
----------y Shape------------
(140700,)</code></pre>
</div>
</div>
<p>En este paso, utilizamos Optuna, una biblioteca eficiente para la optimización de hiperparámetros, con el objetivo de encontrar la mejor configuración para el modelo de CatBoostClassifier. La función de optimización busca maximizar el desempeño del modelo en términos de precisión (accuracy) utilizando un enfoque basado en validación cruzada. Espacio de Búsqueda</p>
<p>El espacio de búsqueda incluye los siguientes hiperparámetros:</p>
<div id="a6aab807" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> objective(trial):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Espacio de búsqueda para los hiperparámetros</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'iterations'</span>: trial.suggest_int(<span class="st">'iterations'</span>, <span class="dv">100</span>, <span class="dv">1000</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'learning_rate'</span>: trial.suggest_float(<span class="st">'learning_rate'</span>, <span class="fl">0.01</span>, <span class="fl">0.3</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'depth'</span>: trial.suggest_int(<span class="st">'depth'</span>, <span class="dv">4</span>, <span class="dv">10</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'colsample_bylevel'</span>: trial.suggest_float(<span class="st">'colsample_bylevel'</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'subsample'</span>: trial.suggest_float(<span class="st">'subsample'</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'min_data_in_leaf'</span>: trial.suggest_int(<span class="st">'min_data_in_leaf'</span>, <span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l2_leaf_reg'</span>: trial.suggest_float(<span class="st">'l2_leaf_reg'</span>, <span class="fl">1.0</span>, <span class="fl">20.0</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'random_strength'</span>: trial.suggest_float(<span class="st">'random_strength'</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Modelo de CatBoost</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> CatBoostClassifier(<span class="op">**</span>params, cat_features<span class="op">=</span><span class="bu">list</span>(obj_feats), verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluación usando validación cruzada</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> cross_val_score(model, X_train, y_train, cv<span class="op">=</span><span class="dv">3</span>, scoring<span class="op">=</span><span class="st">'accuracy'</span>).mean()</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Función Objetivo</p>
<p>La función objetivo se define como el promedio de la precisión obtenida mediante validación cruzada con 3 particiones (<span class="math inline">\(k=3\)</span>):</p>
<p><span class="math display">\[\text{Score} = \frac{1}{k} \sum_{i=1}^{k} \text{Accuracy}(i)\]</span></p>

<p>Donde <span class="math inline">\(\text{Accuracy}(i)\)</span> es la precisión en el <span class="math inline">\(i\)</span>-ésimo fold de la validación cruzada. El modelo de CatBoost se entrena y evalúa en cada iteración con una combinación específica de hiperparámetros sugerida por Optuna.</p>
<div id="9d20c062" class="cell" data-execution_count="23">
 
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> {<span class="st">'iterations'</span>: <span class="dv">633</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'learning_rate'</span>: <span class="fl">0.18918646362839026</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'depth'</span>: <span class="dv">4</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'colsample_bylevel'</span>: <span class="fl">0.9909843814690833</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'subsample'</span>: <span class="fl">0.9778634549619083</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'min_data_in_leaf'</span>: <span class="dv">1</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a> <span class="st">'l2_leaf_reg'</span>: <span class="fl">10.504885456201343</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a> <span class="st">'random_strength'</span>: <span class="fl">0.664861942866057</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="catboost-run" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cat_interp <span class="op">=</span> CatBoostClassifier(<span class="op">**</span>best_params, verbose<span class="op">=</span><span class="va">True</span>, cat_features<span class="op">=</span>X[obj_feats].columns.values, early_stopping_rounds<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cat_cv_last <span class="op">=</span> StratifiedKFold(<span class="dv">20</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>cat_cv_splits <span class="op">=</span> cat_cv_last.split(X, y)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>acc_scores <span class="op">=</span> []</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>last_test_df_preds <span class="op">=</span> []</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>cat_features <span class="op">=</span> X[obj_feats].columns.values</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>X[cat_features] <span class="op">=</span> X[cat_features].fillna(<span class="st">'nan'</span>).astype(<span class="bu">str</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>X_test_df_pool <span class="op">=</span> Pool(test, cat_features<span class="op">=</span>X[obj_feats].columns.values)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (full_train_idx, valid_idx) <span class="kw">in</span> <span class="bu">enumerate</span>(cat_cv_splits):</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    model_fold <span class="op">=</span> CatBoostClassifier(<span class="op">**</span>best_params)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    X_train_fold, X_valid_fold <span class="op">=</span> X.loc[full_train_idx], X.loc[valid_idx]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    y_train_fold, y_valid_fold <span class="op">=</span> y.loc[full_train_idx], y.loc[valid_idx]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    X_train_pool <span class="op">=</span> Pool(X_train_fold, y_train_fold, cat_features<span class="op">=</span>X[obj_feats].columns.values)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    X_valid_pool <span class="op">=</span> Pool(X_valid_fold, y_valid_fold, cat_features<span class="op">=</span>X[obj_feats].columns.values)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    model_fold.fit(X<span class="op">=</span>X_train_pool, eval_set<span class="op">=</span>X_valid_pool, verbose<span class="op">=</span><span class="va">False</span>, early_stopping_rounds<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    valid_pred <span class="op">=</span> model_fold.predict(X_valid_pool)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> accuracy_score(y_valid_fold, valid_pred)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    acc_scores.append(score)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    test_df_pred <span class="op">=</span> model_fold.predict_proba(X_test_df_pool)[:, <span class="dv">1</span>]</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    last_test_df_preds.append(test_df_pred)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Fold </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> Accuracy Score: </span><span class="sc">{</span>score<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fold 1 Accuracy Score: 0.9383</p>
<p>Fold 2 Accuracy Score: 0.9420</p>
<p>Fold 3 Accuracy Score: 0.9375</p>
<p>Fold 4 Accuracy Score: 0.9389</p>
<p>Fold 5 Accuracy Score: 0.9419</p>
<p>Fold 6 Accuracy Score: 0.9407</p>
<p>Fold 7 Accuracy Score: 0.9396</p>
<p>Fold 8 Accuracy Score: 0.9429</p>
<p>Fold 9 Accuracy Score: 0.9403</p>
<p>Fold 10 Accuracy Score: 0.9395</p>
<div id="d419eb29" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_valid_fold, valid_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>